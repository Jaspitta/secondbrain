

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>7.1. Stacks</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/m269.css?v=4f7d186f" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7f41d439"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7.2. Using stacks" href="07_2_stack_usage.html" />
    <link rel="prev" title="7. Stacks and queues" href="07-introduction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            M269
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01_Introduction/01-introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Sequence/02-introduction.html">2. Numbers and sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Selection/03-introduction.html">3. Booleans and selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_Iteration/04-introduction.html">4. Sequences and iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_TMA01-1/05-introduction.html">5. TMA 01 part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_Implementing/06-introduction.html">6. Implementing sequences</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="07-introduction.html">7. Stacks and queues</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">7.1. Stacks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#The-stack-ADT">7.1.1. The stack ADT</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Exercise-7.1.1">Exercise 7.1.1</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Exercise-7.1.2">Exercise 7.1.2</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Implementing-with-an-array">7.1.2. Implementing with an array</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Implementing-with-a-linked-list">7.1.3. Implementing with a linked list</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Exercise-7.1.3">Exercise 7.1.3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="07_2_stack_usage.html">7.2. Using stacks</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_3_queue.html">7.3. Queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_4_priority_queue.html">7.4. Priority queues</a></li>
<li class="toctree-l2"><a class="reference internal" href="07_5_summary.html">7.5. Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../08_Unordered/08-introduction.html">8. Unordered collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_Practice-1/09-introduction.html">9. Practice 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_TMA01-2/10-introduction.html">10. TMA 01 part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_Search/11-introduction.html">11. Exhaustive search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12_Recursion/12-introduction.html">12. Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../13_Divide/13-introduction.html">13. Divide and conquer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../14_Sorting/14-introduction.html">14. Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../15_TMA02-1/15-introduction.html">15. TMA 02 part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../16_Trees/16-introduction.html">16. Rooted trees</a></li>
<li class="toctree-l1"><a class="reference internal" href="../17_Graphs_1/17-introduction.html">17. Graphs 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../18_Greed/18-introduction.html">18. Greed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../19_Practice-2/19-introduction.html">19. Practice 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20_TMA02-2/20-introduction.html">20. TMA 02 part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21_Graphs_2/21-introduction.html">21. Graphs 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../22_Backtracking/22-introduction.html">22. Backtracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../23_Dynamic_Programming/23-introduction.html">23. Dynamic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../24_Practice-3/24-introduction.html">24. Practice 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../25_TMA03-1/25-introduction.html">25. TMA 03 part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../26_Complexity_classes/26-introduction.html">26. Complexity classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../27_Computability/27-introduction.html">27. Computability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../28_TMA03-2/28-introduction.html">28. TMA 03 part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../31_Hints/31-introduction.html">29. Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../32_Answers/32-introduction.html">30. Answers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../33_Figures/33-introduction.html">31. Figures</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">M269</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="07-introduction.html"><span class="section-number">7. </span>Stacks and queues</a></li>
      <li class="breadcrumb-item active"><span class="section-number">7.1. </span>Stacks</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Stacks">
<h1><span class="section-number">7.1. </span>Stacks<a class="headerlink" href="#Stacks" title="Link to this heading"></a></h1>
<p>A pile of boxes is a stack. Only the topmost box can be easily accessed. To access any other box, one usually must remove boxes from the top, one by one. To re-form the pile, one must put each box back on top of the previous boxes.</p>
<p>Computationally, a <strong>stack</strong> is a restricted sequence in which new items are added to and removed from only one end of the sequence. A stack can be seen as a sequence ordered by ‘age’. The ‘oldest’ item, the one added first, is at the bottom of the stack. The ‘youngest’ item, the one added last, is at the top. A stack is a <strong>last-in, first-out (LIFO)</strong> sequence: the last item to be added is the first to be removed.</p>
<div class="admonition note">
<p><strong>Info:</strong> Some texts also use FILO (first-in, last-out) as a synonym for LIFO.</p>
</div>
<section id="The-stack-ADT">
<h2><span class="section-number">7.1.1. </span>The stack ADT<a class="headerlink" href="#The-stack-ADT" title="Link to this heading"></a></h2>
<p>The stack ADT has five operations, where <em>s</em> is some stack:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Effect</p></th>
<th class="head"><p>Algorithm in English</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>new</p></td>
<td><p>create a new empty stack</p></td>
<td><p>let <em>s</em> be an empty stack</p></td>
</tr>
<tr class="row-odd"><td><p>size</p></td>
<td><p>obtain the size of <em>s</em></p></td>
<td><p>│<em>s</em>│</p></td>
</tr>
<tr class="row-even"><td><p>push</p></td>
<td><p>put an item on top of <em>s</em></p></td>
<td><p>push <em>item</em> on <em>s</em></p></td>
</tr>
<tr class="row-odd"><td><p>pop</p></td>
<td><p>remove the top item, if <em>s</em> isn’t empty</p></td>
<td><p>pop <em>s</em></p></td>
</tr>
<tr class="row-even"><td><p>peek</p></td>
<td><p>access the top item, if <em>s</em> isn’t empty</p></td>
<td><p>top of <em>s</em></p></td>
</tr>
</tbody>
</table>
<p>A common alternative pop operation also returns the removed item. This makes the peek operation redundant: the top item can be inspected by popping and pushing it.</p>
<p>A stack is a sequence of objects and so we can use sequence ADT operations in defining the stack ADT. The push, pop and peek operations are simply restricted versions of the insert, remove and indexing operations of the sequence ADT.</p>
<p><strong>ADT</strong>: stack, a sequence of objects</p>
<div class="line-block">
<div class="line"><strong>Function</strong>: new</div>
<div class="line"><strong>Inputs</strong>: none</div>
<div class="line"><strong>Preconditions</strong>: true</div>
<div class="line"><strong>Output</strong>: <em>items</em>, a stack</div>
<div class="line"><strong>Postconditions</strong>: <em>items</em> = ()</div>
</div>
<div class="line-block">
<div class="line"><strong>Function</strong>: size</div>
<div class="line"><strong>Inputs</strong>: <em>items</em>, a stack</div>
<div class="line"><strong>Preconditions</strong>: true</div>
<div class="line"><strong>Output</strong>: <em>count</em>, an integer</div>
<div class="line"><strong>Postconditions</strong>: <em>count</em> = │<em>items</em>│</div>
</div>
<section id="Exercise-7.1.1">
<h3>Exercise 7.1.1<a class="headerlink" href="#Exercise-7.1.1" title="Link to this heading"></a></h3>
<p>Here again is the definition of the insert operation of the sequence ADT from <a class="reference internal" href="../04_Iteration/04_6_lists.html#Modifying-sequences"><span class="std std-ref">Section 4.6</span></a>. Modify it for the push operation for a stack.</p>
<div class="line-block">
<div class="line"><strong>Operation</strong>: insert</div>
<div class="line"><strong>Inputs/Outputs</strong>: <em>values</em>, a sequence</div>
<div class="line"><strong>Inputs</strong>: <em>index</em>, an integer; <em>value</em>, an object</div>
<div class="line"><strong>Preconditions</strong>: 0 ≤ <em>index</em> ≤ │<em>values</em>│</div>
<div class="line"><strong>Postconditions</strong>: post-<em>values</em> = (pre-<em>values</em>[0], …, pre-<em>values</em>[<em>index</em> − 1], <em>value</em>, pre-<em>values</em>[<em>index</em>], …, pre-<em>values</em>[│pre-<em>values</em>│ − 1])</div>
</div>
<p><a class="reference internal" href="../31_Hints/Hints_07_1_01.html"><span class="doc">Hint</span></a> <a class="reference internal" href="../32_Answers/Answers_07_1_01.html"><span class="doc">Answer</span></a></p>
</section>
<section id="Exercise-7.1.2">
<h3>Exercise 7.1.2<a class="headerlink" href="#Exercise-7.1.2" title="Link to this heading"></a></h3>
<p>Modify the definitions of the general remove and indexing operations to become the definitions of the pop and peek operations.</p>
<div class="line-block">
<div class="line"><strong>Operation</strong>: remove</div>
<div class="line"><strong>Inputs/Outputs</strong>: <em>values</em>, a sequence</div>
<div class="line"><strong>Inputs</strong>: <em>index</em>, an integer</div>
<div class="line"><strong>Preconditions</strong>: 0 ≤ <em>index</em> &lt; │<em>values</em>│</div>
<div class="line"><strong>Postconditions</strong>: post-<em>values</em> = (pre-<em>values</em>[0], …, pre-<em>values</em>[<em>index</em> − 1], pre-<em>values</em>[<em>index</em> + 1], …, pre-<em>values</em>[│pre-<em>values</em>│ − 1])</div>
</div>
<div class="line-block">
<div class="line"><strong>Function</strong>: indexing</div>
<div class="line"><strong>Inputs</strong>: <em>values</em>, a sequence; <em>index</em>, an integer</div>
<div class="line"><strong>Preconditions</strong>: 0 ≤ <em>index</em> &lt; │<em>values</em>│</div>
<div class="line"><strong>Output</strong>: <em>value</em>, an object</div>
<div class="line"><strong>Postconditions</strong>: <em>value</em> is the <em>n</em>-th item of <em>values</em>, with <em>n</em> = <em>index</em> + 1</div>
</div>
<p><a class="reference internal" href="../31_Hints/Hints_07_1_02.html"><span class="doc">Hint</span></a> <a class="reference internal" href="../32_Answers/Answers_07_1_02.html"><span class="doc">Answer</span></a></p>
</section>
</section>
<section id="Implementing-with-an-array">
<h2><span class="section-number">7.1.2. </span>Implementing with an array<a class="headerlink" href="#Implementing-with-an-array" title="Link to this heading"></a></h2>
<p>Python doesn’t provide a stack data type because stacks can be easily simulated with lists, as long as we only access, add and remove the last item. Here’s a list being used as a stack:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># stack</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
<span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pop&quot;</span><span class="p">,</span> <span class="n">numbers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
push 0
push 1
push 2
pop 2
pop 1
pop 0
</pre></div></div>
</div>
<p>This example clearly shows the last-in, first-out behaviour of stacks: the items are popped in the opposite order they were pushed.</p>
<p>Since Python’s <code class="docutils literal notranslate"><span class="pre">pop</span></code> method also returns the removed item, it would be daft not to make use of it when convenient. The last two lines of the cell above can be rewritten as a single line: <code class="docutils literal notranslate"><span class="pre">print('pop',</span> <span class="pre">numbers.pop(-1))</span></code>.</p>
<p>Lists are implemented with dynamic arrays, which means that all stack operations have constant-time complexity as they don’t involve any shifting of items.</p>
<p>Using list operations makes it harder to spot that a list is being used as a stack, and this may lead to errors when the code needs to be changed. We therefore implement the ADT with our own class, which simply uses a Python list and calls the corresponding operations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this code is also in m269_stack.py</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Stack</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A last-in, first-out sequence of objects, implemented with a Python list.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the stack to be empty.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of items in the stack.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the top item in the stack.</span>

<span class="sd">        Preconditions: self.size() &gt; 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove and return the top item from the stack.</span>

<span class="sd">        Preconditions: self.size() &gt; 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Put the given item on top of the stack.</span>

<span class="sd">        Postconditions: post-self.peek() == item</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Let’s test the class with the same example as before:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">()</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
<span class="k">while</span> <span class="n">numbers</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pop&quot;</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">peek</span><span class="p">())</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
push 0
push 1
push 2
pop 2
pop 1
pop 0
</pre></div></div>
</div>
<div class="admonition note">
<p><strong>Info:</strong> Class <code class="docutils literal notranslate"><span class="pre">Stack</span></code> in package <code class="docutils literal notranslate"><span class="pre">java.util</span></code> implements the stack ADT in Java. It’s a subclass of <code class="docutils literal notranslate"><span class="pre">java.util.Vector</span></code>, a dynamic array data type.</p>
</div>
<p>We can implement a bounded stack with a static array, like we did for a <a class="reference internal" href="../06_Implementing/06_4_bounded.html#Bounded-sequences"><span class="std std-ref">bounded sequence</span></a>, by keeping track of the current size of the stack.</p>
</section>
<section id="Implementing-with-a-linked-list">
<h2><span class="section-number">7.1.3. </span>Implementing with a linked list<a class="headerlink" href="#Implementing-with-a-linked-list" title="Link to this heading"></a></h2>
<p>The stack ADT can also be implemented with the linked list data structure. With an array, the top item is the <em>last</em> one, at the highest index, so that the push and pop operations don’t have to shift items. With a linked list, the top item is the <em>first</em> one, in the head node, so that the push and pop operations don’t have to traverse the linked list.</p>
<p>Here’s the same stack, obtained by pushing 0, 1 and 2 in this order, stored in a static array with capacity 5, and in a linked list. In both cases, an additional instance variable keeps track of the length.</p>
<p id="fig-7.1.1"></p><p><a class="reference internal" href="../33_Figures/Figures_07_1.html#Figure-7.1.1"><span class="std std-ref">Figure 7.1.1</span></a></p>
<img alt="Image 07_1_list_v_array.png" src="../_images/07_1_list_v_array.png" />
<p>The implementation with a linked list is a special case of implementing sequence operations with a linked list, e.g. the push operation corresponds to <a class="reference internal" href="../06_Implementing/06_7_linked_list.html#Inserting-an-item"><span class="std std-ref">inserting at index 0</span></a>. Each stack operation takes constant time, as it involves a few assignments to update pointers and an integer operation to update the length.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this code is also in m269_stack.py</span>


<span class="k">class</span><span class="w"> </span><span class="nc">LinkedListStack</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A last-in, first-out sequence of objects, implemented with a linked list.&quot;&quot;&quot;</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Node</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;A node in a linked list.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Initialise the node with the given item.&quot;&quot;&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">item</span> <span class="o">=</span> <span class="n">item</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the stack to be empty.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the number of items in the stack.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">peek</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the top item in the stack.</span>

<span class="sd">        Preconditions: self.size() &gt; 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">item</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Remove and return the top item from the stack.</span>

<span class="sd">        Preconditions: self.length() &gt; 0</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">item</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span><span class="o">.</span><span class="n">next</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">item</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Put the given item on top of the stack.</span>

<span class="sd">        Postconditions: post-self.peek() == item</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="n">LinkedListStack</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">node</span><span class="o">.</span><span class="n">next</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">head</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">head</span> <span class="o">=</span> <span class="n">node</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">length</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<p>And once more the same test:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="n">LinkedListStack</span><span class="p">()</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;push&quot;</span><span class="p">,</span> <span class="n">number</span><span class="p">)</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>
<span class="k">while</span> <span class="n">numbers</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pop&quot;</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">peek</span><span class="p">())</span>
    <span class="n">numbers</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
push 0
push 1
push 2
pop 2
pop 1
pop 0
</pre></div></div>
</div>
<section id="Exercise-7.1.3">
<h3>Exercise 7.1.3<a class="headerlink" href="#Exercise-7.1.3" title="Link to this heading"></a></h3>
<p>Is it better to implement stacks with dynamic arrays or linked lists?</p>
<p><a class="reference internal" href="../31_Hints/Hints_07_1_03.html"><span class="doc">Hint</span></a> <a class="reference internal" href="../32_Answers/Answers_07_1_03.html"><span class="doc">Answer</span></a></p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="07-introduction.html" class="btn btn-neutral float-left" title="7. Stacks and queues" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="07_2_stack_usage.html" class="btn btn-neutral float-right" title="7.2. Using stacks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2025 The Open University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>