

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>16.3. Traversals</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
      <link rel="stylesheet" type="text/css" href="../_static/m269.css?v=4f7d186f" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=7f41d439"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="16.4. Binary search trees" href="16_4_bst.html" />
    <link rel="prev" title="16.2. Algorithms on trees" href="16_2_algorithms.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            M269
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../01_Introduction/01-introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02_Sequence/02-introduction.html">2. Numbers and sequence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03_Selection/03-introduction.html">3. Booleans and selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04_Iteration/04-introduction.html">4. Sequences and iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05_TMA01-1/05-introduction.html">5. TMA 01 part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06_Implementing/06-introduction.html">6. Implementing sequences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07_Ordered/07-introduction.html">7. Stacks and queues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08_Unordered/08-introduction.html">8. Unordered collections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09_Practice-1/09-introduction.html">9. Practice 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10_TMA01-2/10-introduction.html">10. TMA 01 part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11_Search/11-introduction.html">11. Exhaustive search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12_Recursion/12-introduction.html">12. Recursion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../13_Divide/13-introduction.html">13. Divide and conquer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../14_Sorting/14-introduction.html">14. Sorting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../15_TMA02-1/15-introduction.html">15. TMA 02 part 1</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="16-introduction.html">16. Rooted trees</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="16_1_binary.html">16.1. Binary tree</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_2_algorithms.html">16.2. Algorithms on trees</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">16.3. Traversals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Depth-first-search">16.3.1. Depth-first search</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Pre-order-traversal">16.3.2. Pre-order traversal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#In-order-traversal">16.3.3. In-order traversal</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Exercise-16.3.1">Exercise 16.3.1</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Post-order-traversal">16.3.4. Post-order traversal</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Breadth-first-search">16.3.5. Breadth-first search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="16_4_bst.html">16.4. Binary search trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_5_balanced.html">16.5. Balanced trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_6_heapsort.html">16.6. Heapsort</a></li>
<li class="toctree-l2"><a class="reference internal" href="16_7_summary.html">16.7. Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../17_Graphs_1/17-introduction.html">17. Graphs 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../18_Greed/18-introduction.html">18. Greed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../19_Practice-2/19-introduction.html">19. Practice 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../20_TMA02-2/20-introduction.html">20. TMA 02 part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../21_Graphs_2/21-introduction.html">21. Graphs 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../22_Backtracking/22-introduction.html">22. Backtracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../23_Dynamic_Programming/23-introduction.html">23. Dynamic Programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="../24_Practice-3/24-introduction.html">24. Practice 3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../25_TMA03-1/25-introduction.html">25. TMA 03 part 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../26_Complexity_classes/26-introduction.html">26. Complexity classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../27_Computability/27-introduction.html">27. Computability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../28_TMA03-2/28-introduction.html">28. TMA 03 part 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../31_Hints/31-introduction.html">29. Hints</a></li>
<li class="toctree-l1"><a class="reference internal" href="../32_Answers/32-introduction.html">30. Answers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../33_Figures/33-introduction.html">31. Figures</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">M269</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="16-introduction.html"><span class="section-number">16. </span>Rooted trees</a></li>
      <li class="breadcrumb-item active"><span class="section-number">16.3. </span>Traversals</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Traversals">
<h1><span class="section-number">16.3. </span>Traversals<a class="headerlink" href="#Traversals" title="Link to this heading"></a></h1>
<p>To do a brute-force search over a binary tree we must traverse it to visit all its nodes. The traversal generates the candidates and visiting a node does the testing, i.e. checks if it satisfies the search criteria.</p>
<p>Traversals can be used for non-search problems too, e.g. to print the tree. Visiting a node processes its item and what is done depends on the problem, e.g. the size operation process a node by adding one to count.</p>
<p>There are several systematic ways of traversing a binary tree. Once again I’ll use the tree for expression (3+4)×5−6 to illustrate the concepts.</p>
<p id="fig-16.3.1"></p><p><a class="reference internal" href="../33_Figures/Figures_16_3.html#Figure-16.3.1"><span class="std std-ref">Figure 16.3.1</span></a></p>
<img alt="Image 16_1_example.png" src="../_images/16_1_example.png" />
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> -i ../m269_tree

<span class="c1"># MTP is short for minus, times, plus</span>
<span class="n">MTP</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">join</span><span class="p">(</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">join</span><span class="p">(</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">THREE</span><span class="p">,</span> <span class="n">FOUR</span><span class="p">),</span> <span class="n">FIVE</span><span class="p">),</span> <span class="n">SIX</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Depth-first-search">
<h2><span class="section-number">16.3.1. </span>Depth-first search<a class="headerlink" href="#Depth-first-search" title="Link to this heading"></a></h2>
<p>Traversals can be classified according to whether the root is visited before, in between or after visiting the subtrees.</p>
<p>A <strong>pre-order</strong> traversal first visits the root, then the left subtree, then the right subtree. For the example tree, it would visit nodes −, ×, +, 3, 4, 5, 6 in that order.</p>
<p>An <strong>in-order</strong> traversal first visits the left subtree, then the root, then the right subtree. For the example tree, the visiting order is 3, +, 4, ×, 5, −, 6. The in-order traversal generates the usual <a class="reference internal" href="../07_Ordered/07_2_stack_usage.html#Postfix-expressions"><span class="std std-ref">infix notation</span></a> of expressions (operator between operands) but without the brackets.</p>
<p>A <strong>post-order</strong> traversal first visits the left subtree, then the right subtree and finally the root. For the example tree, the visiting order is 3, 4, +, 5, ×, 6, −. This is the <a class="reference internal" href="../07_Ordered/07_2_stack_usage.html#Postfix-expressions"><span class="std std-ref">postfix notation</span></a> that can be evaluated with a stack.</p>
<p>All these traversals are forms of <strong>depth-first search</strong> (<strong>DFS</strong>), a search that explores one subtree in depth before searching the other subtree.</p>
</section>
<section id="Pre-order-traversal">
<h2><span class="section-number">16.3.2. </span>Pre-order traversal<a class="headerlink" href="#Pre-order-traversal" title="Link to this heading"></a></h2>
<p>The algorithmic pattern for preorder(<em>tree</em>) is as follows, where step 2 is problem-dependent.</p>
<ol class="arabic simple">
<li><p>if <em>tree</em> is empty:</p>
<ol class="arabic simple">
<li><p>stop</p></li>
</ol>
</li>
<li><p>visit root(<em>tree</em>)</p></li>
<li><p>preorder(left(<em>tree</em>))</p></li>
<li><p>preorder(right(<em>tree</em>))</p></li>
</ol>
<p>A pre-order traversal can be used to print a tree. In this case, step 2 prints the root’s value.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this code is also in m269_tree.py</span>


<span class="k">def</span><span class="w"> </span><span class="nf">write</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">level</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the tree as in file browsers, with subtrees indented.</span>

<span class="sd">    Preconditions: level &gt;= 0 is the initial indentation level</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">level</span><span class="p">,</span> <span class="s2">&quot;EMPTY&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">level</span><span class="p">,</span> <span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
        <span class="n">write</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">write</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">level</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">write</span><span class="p">(</span><span class="n">MTP</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># compare the output to the figure above</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
 -
     *
         +
             3
                 EMPTY
                 EMPTY
             4
                 EMPTY
                 EMPTY
         5
             EMPTY
             EMPTY
     6
         EMPTY
         EMPTY
</pre></div></div>
</div>
<p>The pre-order pattern may be modified for some problems. For example, when searching for an item in a tree, we can stop the traversal when we find it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">has</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if and only if the item occurs in the tree.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">tree</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="n">tree</span><span class="o">.</span><span class="n">root</span> <span class="o">==</span> <span class="n">item</span><span class="p">:</span>  <span class="c1"># visit a node</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">has</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span> <span class="ow">or</span> <span class="n">has</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>


<span class="n">has</span><span class="p">(</span><span class="n">MTP</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
False
</pre></div></div>
</div>
<p>This is similar to the recursive membership operation <a class="reference internal" href="../12_Recursion/12_4_inspect_sequences.html#Membership"><span class="std std-ref">on sequences</span></a>, which has two analogous base cases: the empty sequence and the head is the sought item.</p>
<p>The code uses short-circuit disjunction to search the right subtree only if the item isn’t in the left subtree. In languages without short-circuiting we’d write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">has</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">left</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
    <span class="k">return</span> <span class="kc">True</span>
<span class="k">return</span> <span class="n">has</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">right</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
</pre></div>
</div>
<p>Exhaustive search algorithms on trees usually do a pre-order traversal because by first looking at the root they may avoid visiting the subtrees.</p>
</section>
<section id="In-order-traversal">
<h2><span class="section-number">16.3.3. </span>In-order traversal<a class="headerlink" href="#In-order-traversal" title="Link to this heading"></a></h2>
<p>Other than the name of the recursive function, what do we need to change in the pre-order pattern to obtain in-order traversal?</p>
<hr class="docutils" />
<p>We just need to swap steps 2 and 3 to visit the left subtree before the root.</p>
<p>A plain in-order traversal of an expression tree produces the expression in infix notation but without the parentheses. This is wrong because the original expression (3+4)×5−6 becomes 3+4×5−6 which, according to the usual precedence of operators, means 3+(4×5)−6. We have to print each subtree within brackets.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">infix</span><span class="p">(</span><span class="n">expression</span><span class="p">:</span> <span class="n">Tree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print infix form of expression, with full brackets.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>  <span class="c1"># print nothing after (</span>
    <span class="n">infix</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">infix</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>


<span class="n">infix</span><span class="p">(</span><span class="n">MTP</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((((  3  )  +  (  4  ))  *  (  5  ))  -  (  6  ))
</pre></div></div>
</div>
<p>When the <code class="docutils literal notranslate"><span class="pre">print</span></code> function has argument <code class="docutils literal notranslate"><span class="pre">end=s</span></code>, it prints string <code class="docutils literal notranslate"><span class="pre">s</span></code> instead of the newline character.</p>
<section id="Exercise-16.3.1">
<h3>Exercise 16.3.1<a class="headerlink" href="#Exercise-16.3.1" title="Link to this heading"></a></h3>
<p>Here’s the function again with some more tests. Change it so that brackets around integer literals aren’t printed.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">infix</span><span class="p">(</span><span class="n">expression</span><span class="p">:</span> <span class="n">Tree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print infix form of expression, with full brackets.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">infix</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">expression</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">infix</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>


<span class="n">infix</span><span class="p">(</span><span class="n">MTP</span><span class="p">)</span>  <span class="c1"># ((3+4)*5)–6</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">infix</span><span class="p">(</span><span class="n">TPM</span><span class="p">)</span>  <span class="c1"># (3+4)*(5-6)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">infix</span><span class="p">(</span><span class="n">PMT</span><span class="p">)</span>  <span class="c1"># 3+((4*5)-6)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="n">infix</span><span class="p">(</span><span class="n">MPT</span><span class="p">)</span>  <span class="c1"># (3+(4*5))-6</span>
</pre></div>
</div>
</div>
<p><a class="reference internal" href="../31_Hints/Hints_16_3_01.html"><span class="doc">Hint</span></a> <a class="reference internal" href="../32_Answers/Answers_16_3_01.html"><span class="doc">Answer</span></a></p>
</section>
</section>
<section id="Post-order-traversal">
<h2><span class="section-number">16.3.4. </span>Post-order traversal<a class="headerlink" href="#Post-order-traversal" title="Link to this heading"></a></h2>
<p>Other than the name of the recursive function, what do we need to change to the pre-order pattern to obtain post-order traversal?</p>
<hr class="docutils" />
<p>We must move step 2 (visit the root) to the end of the algorithm, after visiting the right subtree.</p>
<p>We can evaluate an expression tree with a post-order traversal, because we can only process an operator after evaluating the left and right operands. The base case isn’t the empty tree as that has no defined value; it’s a leaf (a literal).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">evaluate</span><span class="p">(</span><span class="n">expression</span><span class="p">:</span> <span class="n">Tree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the value of the expression tree.</span>

<span class="sd">    Preconditions:</span>
<span class="sd">    - expression isn&#39;t empty</span>
<span class="sd">    - expression only has operators +, -, * and numeric operands</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_leaf</span><span class="p">(</span><span class="n">expression</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">expression</span><span class="o">.</span><span class="n">root</span>
    <span class="n">left_value</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
    <span class="n">right_value</span> <span class="o">=</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
    <span class="n">operator</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">root</span>
    <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;+&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left_value</span> <span class="o">+</span> <span class="n">right_value</span>
    <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;-&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left_value</span> <span class="o">-</span> <span class="n">right_value</span>
    <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s2">&quot;*&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">left_value</span> <span class="o">*</span> <span class="n">right_value</span>


<span class="n">infix</span><span class="p">(</span><span class="n">MTP</span><span class="p">)</span>  <span class="c1"># ((3+4)*5)–6</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; =&quot;</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">MTP</span><span class="p">))</span>
<span class="n">infix</span><span class="p">(</span><span class="n">TPM</span><span class="p">)</span>  <span class="c1"># (3+4)*(5-6)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; =&quot;</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">TPM</span><span class="p">))</span>
<span class="n">infix</span><span class="p">(</span><span class="n">PMT</span><span class="p">)</span>  <span class="c1"># 3+((4*5)-6)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; =&quot;</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">PMT</span><span class="p">))</span>
<span class="n">infix</span><span class="p">(</span><span class="n">MPT</span><span class="p">)</span>  <span class="c1"># (3+(4*5))-6</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; =&quot;</span><span class="p">,</span> <span class="n">evaluate</span><span class="p">(</span><span class="n">MPT</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
((((  3  )  +  (  4  ))  *  (  5  ))  -  (  6  )) = 29
(((  3  )  +  (  4  ))  *  ((  5  )  -  (  6  ))) = -7
((  3  )  +  (((  4  )  *  (  5  ))  -  (  6  ))) = 17
(((  3  )  +  ((  4  )  *  (  5  )))  -  (  6  )) = 17
</pre></div></div>
</div>
<p>If you run this cell after doing the previous exercise you get fewer brackets.</p>
</section>
<section id="Breadth-first-search">
<h2><span class="section-number">16.3.5. </span>Breadth-first search<a class="headerlink" href="#Breadth-first-search" title="Link to this heading"></a></h2>
<p>A <strong>level-order</strong> traversal goes through the tree level by level, from left to right within each level. This is a form of <strong>breadth-first search</strong> (<strong>BFS</strong>) because it goes through the breadth of each level before moving down to the next one.</p>
<p>Depth-first search uses the call stack of the interpreter for the recursive calls; breath-first search uses a queue. When we visit a node, we enqueue its children, i.e. the next level, to visit them later. As we visit each level from left to right and enqueue its children, the next level will also be traversed left to right. The front of the queue is the next node to be visited. When we reach a leaf, no children are enqueued. At some point the queue will be empty and the algorithm stops. Here’s
the BFS pattern:</p>
<ol class="arabic simple">
<li><p>let <em>to visit</em> be the empty queue</p></li>
<li><p>enqueue <em>tree</em> in <em>to visit</em></p></li>
<li><p>while <em>to visit</em> isn’t empty:</p>
<ol class="arabic simple">
<li><p>dequeue <em>tree</em> from <em>to visit</em></p></li>
<li><p>visit root(<em>tree</em>)</p></li>
<li><p>if left(<em>tree</em>) isn’t empty:</p>
<ol class="arabic simple">
<li><p>enqueue left(<em>tree</em>) in <em>to visit</em></p></li>
</ol>
</li>
<li><p>if right(<em>tree</em>) isn’t empty:</p>
<ol class="arabic simple">
<li><p>enqueue right(<em>tree</em>) in <em>to visit</em></p></li>
</ol>
</li>
</ol>
</li>
</ol>
<p>Here’s a version of level-order traversal that prints one level per line. It uses two queues, one for the current level and the other for the next level, to detect when the current level ends and print a newline.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">run</span> -i ../m269_queue


<span class="k">def</span><span class="w"> </span><span class="nf">levels</span><span class="p">(</span><span class="n">tree</span><span class="p">:</span> <span class="n">Tree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print the tree from the root down, one level per line.&quot;&quot;&quot;</span>
    <span class="n">this_level</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
    <span class="n">next_level</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
    <span class="n">this_level</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">this_level</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">tree</span> <span class="o">=</span> <span class="n">this_level</span><span class="o">.</span><span class="n">dequeue</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">left</span><span class="p">):</span>
            <span class="n">next_level</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">left</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_empty</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">right</span><span class="p">):</span>
            <span class="n">next_level</span><span class="o">.</span><span class="n">enqueue</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">right</span><span class="p">)</span>
        <span class="c1"># if it was last tree of this level, start new line and level</span>
        <span class="k">if</span> <span class="n">this_level</span><span class="o">.</span><span class="n">size</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">()</span>
            <span class="n">this_level</span> <span class="o">=</span> <span class="n">next_level</span>
            <span class="n">next_level</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>


<span class="n">levels</span><span class="p">(</span><span class="n">MTP</span><span class="p">)</span>  <span class="c1"># (3+4) * 5 - 6</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-
*  6
+  5
3  4
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">levels</span><span class="p">(</span><span class="n">TPM</span><span class="p">)</span>  <span class="c1"># (3+4) * (5-6)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
*
+  -
3  4  5  6
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="16_2_algorithms.html" class="btn btn-neutral float-left" title="16.2. Algorithms on trees" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="16_4_bst.html" class="btn btn-neutral float-right" title="16.4. Binary search trees" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020–2025 The Open University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>